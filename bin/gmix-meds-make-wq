#!/usr/bin/env python
"""
    %prog [options] config_file meds_file(s)
"""

import sys
import gmix_meds
import meds
import yaml

from optparse import OptionParser
parser = OptionParser(__doc__)

parser.add_option('--missing',action='store_true',
                  help="generate for missing output files")

class Maker(dict):
    def __init__(self, config_file, meds_files, missing=False):
        self.config_file=config_file
        self.meds_files=meds_files

        self._load_config()
        self._count_objects()

    def _load_config(self):
        with open(self.config_file) as fobj:
            conf=yaml.load(fobj)

        self.update(conf)

    def _count_objects(self):
        fname=self.meds_files[0]
        with meds.MEDS(fname) as meds_obj:
            nobj=meds_obj.size

        self['nobj']=nobj

    def make_scripts(self):
        nper=self['nper']
        nobj=self['nobj']

        indices=numpy.arange(nobj)
        nchunk=nobj/nper

        self.fileno=0
        self.nwrite=0

        for i in xrange(nobj):

            beg=i*nper
            end=(i+1)*nper
            olist=indices[beg:end]

def main():
    options, args = parser.parse_args(sys.argv[1:])
    if len(args) < 3:
        parser.print_help()
        sys.exit(45)


main()
