#!/usr/bin/env python
"""
    %prog [options] run_name config_file meds_file(s)
"""
from __future__ import print_function
import os
import sys
import numpy

import gmix_meds
from gmix_meds.files import CondorMaker, DEFAULT_NPER

from optparse import OptionParser

parser = OptionParser(__doc__)
parser.add_option('--nper',default=DEFAULT_NPER,
                  help="number of objects per split.  Default %default")
parser.add_option('--root-dir',
                  help="root dir for files.  Default is $GMIX_MEDS_DATADIR")
parser.add_option('--missing',action='store_true',
                  help="generate for missing output files")
parser.add_option('--sub-dir',
        help="associate a sub-dir, e.g. a DES tilename 'DES0453-4748'")


def main():
    options, args = parser.parse_args(sys.argv[1:])
    if len(args) < 3:
        parser.print_help()
        sys.exit(45)

    run_name=args[0]
    config_file=args[1]
    meds_files=args[2:]

    maker=CondorMaker(run_name,
                      config_file,
                      meds_files,
                      nper=int(options.nper),
                      root_dir=options.root_dir,
                      missing=options.missing,
                      sub_dir=options.sub_dir)

    maker.write()

main()
